---
title: 页面埋点基础概念
date: 2023-04-25 22:34:53
categories:
  - 技术学习
tags:
  - 埋点
  - JavaScript
---

所谓埋点可以理解为在应用中通过代码来采集上报一些信息，用于分析应用使用的状况，后续用来进一步优化产品或是提供运营的数据支撑。对于公司来说埋点的业务意义非常重要。

<!-- more -->

## 常见的埋点方式

埋点常用的技术方案有三种：代码侵入埋点、可视化埋点、无埋点。

### 代码侵入埋点

代码埋点就是在你需要统计数据的地方植入 N 行代码，统计用户的关键行为。

- 优点：使用者控制精准，可以非常精确地选择什么时候发送数据；使用者可以比较方便地设置自定义属性、自定义事件，传递比较丰富的数据到服务端
- 缺点：每一个控件的埋点都需要添加相应的代码，工作量大，对业务代码的侵入性高；存在更新代价，每一次更新，都需要通过各个应用市场进行分发，而且有的用户还不一定更新，就会流失这部分客户的数据

但综合来说代码埋点对于公司自研的角度是最容易实现的。

主流的埋点模型目前有两种：utm 埋点和 spm 埋点

#### utm 埋点

由 Google Analytics 提出，utm 是“Urchin Tracking Module”的简写，大意就是跟踪模块。主要的参数包括这些

|     参数     |           意义            |
| :----------: | :-----------------------: |
| utm_campaign |       推广活动名称        |
| utm_content  |       推广活动内容        |
|  utm_source  | 推广活动来源，例如：baidu |
|  utm_medium  | 推广活动媒介，例如：email |
|   utm_term   |      推广活动关键词       |

#### spm 埋点

由阿里提出，主要是用于追踪具体的站内位置。阿里的 SPM 位置编码由 A.B.C.D 四段构成, 各分段分别代表

- A:站点/业务；
- B:页面；
- C:页面区块；
- D:区块内点位。

SPM 的基本功能个人认为包括这些：

跳转拼接：通过页面，区块，点位信息去拼接 spm 码，页面跳转时将 spm 添加到 url 的 query 参数。
埋点上报：通过解析 URL 提取参数，完善 pv 链的顺序，页面的 pv 上报时就能获取当前页面信息和上一个页面信息。

### 可视化埋点

可视化埋点的具体操作是：在可视化界面上打开项目地址，并圈选需要埋点的 DOM 元素，对选中的 DOM 元素添加自定义埋点事件；完成后可视化平台会根据保存的事件列表生成一个 JS 文件，需要将其埋入应用。
该方式的实现原理是：在进行事件设置的时候，“可视化埋点工具”会利用它部署在网站页面（或者 app）上的基础代码对网站（或 app）上所有的可交互事件元素进行解析，获取它们的 DOM path。

- 优点：操作简单
- 缺点：上报的场景比较受限，跟事件操作强关联；埋点配置需要独立发布

该方式实现的代表三方为 talkingData、Mixpanel

### 无埋点

无埋点也可以理解为全埋点，前端引入的 SDK 会自动劫持页面所有的事件、进行自主上报。

- 优点：对业务代码的侵入量少，操作简单
- 缺点：会产生大量的上报请求，服务器的压力会比较大；如果没有合适的数据清洗规范，后台看到的数据就难以进行分析

一般来说无埋点方案可能会直接使用现有的三方 SDK 如 GrowingIO、神策等。

## 参考文献
（1）[初识 SPM](https://juejin.cn/post/7151400818594283557)
（2）[流量追踪：如何通过URL进行数据采集？谷歌UTM参数及阿里SPM介绍](https://www.shangyexinzhi.com/article/4258360.html)
（3）[前端埋点的那些事](http://www.imooc.com/article/27151)
