---
title: 正则表达式
date: 2022-04-05 20:35:30
categories:
  - 前端基础
tags:
  - 正则表达式
---
正则表达式构建相关知识点。
<!-- more --> 


## 单字符匹配
1. 数字、字母：直接书写
2. 特殊字符（eg.空格、换行、*）：使用转义字符`\`
需要记忆的特殊字符：
| 特殊字符 | 正则表达式 |
| :----: | :----: |
| 转行符 | \n | 
| 空白符 | \s | 
| 制表符 | \t | 
| 回车符 | \r | 

## 多字符匹配
1. [] eg.[a-z],[0-9]
2. 简便正则表达式
| 特殊字符 | 正则表达式 |
| :----: | :----: |
| 除了换行符之外的任何字符 | . | 
| 匹配空白符，包括空格、制表符、换页符和换行符 | \s | 
| 匹配非空白字符([^ \t\v\n\r\f]) | \S | 
| 单个数字, [0-9] | \d | 
| 除了0-9([^0-9]) | \D | 
| 包括下划线在内的单个字符，[A-Za-z0-9_] | \w | 
| 非单个字符([^A-Za-z0-9_]) | \W | 

## 重复次数
| 特殊字符 | 重复次数 |
| :----: | :----: |
| ? | 0-1 | 
| * | 0-n | 
| + | 1-n | 
| {n} | n | 
| {min,max} | min-max | 

### 贪婪匹配和惰性匹配
贪婪匹配：重复次数不是固定而是一个范围时通常尽可能多的匹配。
````
var regex = /\d{2,5}/g;
var string = "12345";
console.log( string.match(regex) ); 
// => ["12345"]
````

懒惰匹配：在上述表格的字符后面加上`?`，尽可能少的匹配。
````
var regex = /\d{2,5}?/g;
var string = "12345";
console.log( string.match(regex) ); 
// => ["12","34"]
````
## 分组与回溯引用
**分组**：括号()所包裹的表达式内容即为一个分组。

**回溯引用**：模式的后面部分引用前面已经匹配到的子字符串。
示例：
````
var regex = /\d{4}(-|\/|\.)\d{2}\1\d{2}/;
````
在这个正则表达式中\1，表示的引用之前的那个分组`(-|\/|\.)`。不管它匹配到什么（比如-），\1都匹配那个同样的具体某个字符。
使用replace替换字符串时，涉及到的引用变量及其意义包括：
````
$1,$2,...,$99 匹配第1~99个分组里捕获的文本
$& 匹配到的子串文本
$` 匹配到的子串的左边文本
$' 匹配到的子串的右边文本
````
### 非捕获分组(?:p)
该语法仅承担分组的作用而不参与引用，即既不在API里引用，也不在正则里反向引用。
## 位置匹配
### 位置特性
位置是相邻字符之间的位置。例如：
“halo”==“”+“h”+“”+“a”+“”+“l”+“”+“o”
### 位置边界
1. 单词边界：\b
示例：
````
var result = "[JS] Lesson_01.mp4".replace(/\b/g, '#');
console.log(result); 
// => "[#JS#] #Lesson_01#.#mp4#"
````
可以看到\b匹配的位置都是由`\w`到`\W`或者`\W`到`\w`的位置
2. 字符串边界：`^`开头匹配，`$`结尾匹配
### 位置查找
#### 前向查找(?=p)
匹配内容p前面的字符。
````
var result = "hello".replace(/(?=l)/g, '#');
console.log(result); 
// => "he#l#lo"
````
#### 后向查找(?<=p)
匹配内容p后面的字符。
````
var result = "hello".replace(/(?=l)/g, '#');
console.log(result); 
// => "hel#l#o"
````
#### 前向负查找(?!p)
不匹配内容p前面的字符。可以看作是前向查找的反面
````
var result = "hello".replace(/(?!l)/g, '#');
console.log(result); 
// => "#h#ell#o#"
````
#### 后向负查找(?<!p)
不匹配内容p后面的字符。可以看作是后向查找的反面
````
var result = "hello".replace(/(?<!l)/g, '#');
console.log(result); 
// => "#h#e#llo#"
````
## 正则表达式相关API
### RegExp 对象方法
#### exec
检索字符串中指定的值。返回找到的值及index，并确定其位置。
exec方法能接着上一次匹配后继续匹配。正则实例lastIndex属性，表示下一次匹配开始的位置。
```
const patternMatch = (pattern, content) => {
    var positions = []
    var match = pattern.exec(content)
    while (match) {
        positions.push(match.index)
        match = pattern.exec(content)
    }
    return positions
}
```
#### test
检索字符串中指定的值。返回 true 或 false。
### String 对象方法
第1参数都支持正则和字符串
#### match
找到一个或多个正则表达式的匹配。返回找到的值
当正则没有g时，使用match返回的信息比较多。但是有g后，就没有关键的信息index了。
#### search
检索与正则表达式相匹配的值。返回与指定查找的字符串或者正则表达式相匹配的 String 对象起始位置，没有则是-1。
#### replace
替换与正则表达式匹配的子串。
replace第2个参数可以是一个普通的字符串或是一个回调函数。如果第2个参数是回调函数，每匹配到一个结果就回调一次，每次回调都会传递以下参数：
```
result: 本次匹配到的结果

$1,...$9: 正则表达式中有几个()，就会传递几个参数，$1~$9分别代表本次匹配中每个()提取的结果，最多9个

offset:记录本次匹配的开始位置

source:接受匹配的原始字符串
```

## 实际应用
（1）js数字每三位加逗号间隔（除了toLocaleString方法）
```
num.replace(/\d{1,3}(?=(\d{3})+(\.\d*)?$)/g,'$&,')
```
`$& `匹配到的子串文本

（2）驼峰变量名转下划线变量
```
str.replace(/([a-z])([A-Z])/g,'$1_$2')
```
（3）下划线变量转驼峰变量名
```
str.replace(/\_([a-z])/g,function(res,$1){return $1.toUpperCase()})
```
（4）成对html标签匹配
```
var regex = /<([^>]+)>[\d\D]*<\/\1>/;
```

## 参考文献
（1）[正则表达式不要背](https://juejin.cn/post/6844903845227659271#heading-0)
（2）[JS正则表达式完整教程（略长）](https://juejin.cn/post/6844903487155732494#heading-38)